name: WES
id: https://w3id.org/htan/wes
description: HTAN Whole Exome Sequencing Data Model Schema
imports:
  - linkml:types
  - linkml:extensions

prefixes:
  htan: https://w3id.org/htan/
  linkml: https://w3id.org/linkml/
  schema: http://schema.org/
  NCIT: http://purl.obolibrary.org/obo/NCIT_
  caDSR: https://cadsr.cancer.gov/onedata/

default_prefix: htan

enums:
  ComponentEnum:
    permissible_values:
      "Bulk WES Level 1":
        description: Bulk Whole Exome Sequencing raw files
      "Bulk WES Level 2":
        description: Bulk Whole Exome Sequencing aligned files and QC
      "Bulk WES Level 3":
        description: Bulk Whole Exome Sequencing called variants

  LibraryLayoutEnum:
    permissible_values:
      "Paired-end":
        description: Paired-end sequencing
      "Single-end":
        description: Single-end sequencing

  LibrarySelectionMethodEnum:
    permissible_values:
      "Hybrid Selection":
        description: Hybrid selection method
      "PCR":
        description: PCR-based selection
      "RANDOM":
        description: Random selection
      "other":
        description: Other selection method

  SequencingPlatformEnum:
    permissible_values:
      "ILLUMINA":
        description: Illumina sequencing platform
      "PACBIO_SMRT":
        description: PacBio SMRT sequencing platform
      "OXFORD_NANOPORE":
        description: Oxford Nanopore sequencing platform
      "ION_TORRENT":
        description: Ion Torrent sequencing platform
      "COMPLETE_GENOMICS":
        description: Complete Genomics sequencing platform
      "CAPILLARY":
        description: Capillary sequencing platform
      "LS454":
        description: 454 sequencing platform
      "ABI_SOLID":
        description: ABI SOLID sequencing platform
      "HELICOS":
        description: Helicos sequencing platform
      "BGISEQ":
        description: BGI sequencing platform

  MSIStatusEnum:
    permissible_values:
      "MSI-H":
        description: High microsatellite instability
      "MSI-L":
        description: Low microsatellite instability
      "MSS":
        description: Microsatellite stable
      "Unknown":
        description: Unknown MSI status

  SomaticVariantsSampleTypeEnum:
    permissible_values:
      "Primary":
        description: Primary tumor sample
      "Metastatic":
        description: Metastatic tumor sample
      "Recurrent":
        description: Recurrent tumor sample
      "Normal":
        description: Normal tissue sample
      "Other":
        description: Other sample type

slots:
  caDSR_id:
    description: The caDSR identifier for this element
    range: string
    multivalued: false
    required: false

classes:
  WESData:
    description: Container for all WES data
    attributes:
      COMPONENT:
        range: ComponentEnum
        required: true
        description: Category of metadata (e.g. Bulk WES Level 1, Bulk WES Level 2, Bulk WES Level 3)
      HTAN_PARTICIPANT_ID:
        range: string
        required: true
        pattern: "^(HTA20[0-9])(?:_0000)?(?:_\\d+)?(?:_EXT\\d+)?_(B|D)\\d{1,50}$"
        description: HTAN Identifier of the research participant
      LEVEL_1_DATA:
        range: BulkWESLevel1
        required: false
        description: Level 1 WES data (raw files)
      LEVEL_2_DATA:
        range: BulkWESLevel2
        required: false
        description: Level 2 WES data (aligned files and QC)
      LEVEL_3_DATA:
        range: BulkWESLevel3
        required: false
        description: Level 3 WES data (called variants)

  BulkWESLevel1:
    description: Bulk Whole Exome Sequencing Level 1 - Raw files
    attributes:
      COMPONENT:
        range: string
        required: true
        description: Category of metadata (should be "Bulk WES Level 1")
      FILENAME:
        range: string
        required: true
        description: Name of the file
      FILE_FORMAT:
        range: string
        required: true
        description: Format of the file (e.g., fastq, bam)
      HTAN_PARENT_BIOSPECIMEN_ID:
        range: string
        required: true
        description: HTAN Biospecimen ID of the parent biospecimen
      HTAN_DATA_FILE_ID:
        range: string
        required: true
        description: HTAN Data File ID
      SEQUENCING_BATCH_ID:
        range: string
        required: false
        description: Sequencing batch identifier
      LIBRARY_LAYOUT:
        range: LibraryLayoutEnum
        required: true
        description: Library layout (paired-end or single-end)
      READ_INDICATOR:
        range: string
        required: false
        description: Read indicator
      LIBRARY_SELECTION_METHOD:
        range: LibrarySelectionMethodEnum
        required: true
        description: Method used for library selection
      READ_LENGTH:
        range: integer
        required: true
        description: Read length in base pairs
      TARGET_CAPTURE_KIT:
        range: string
        required: false
        description: Target capture kit used
      LIBRARY_PREPARATION_KIT_NAME:
        range: string
        required: false
        description: Name of the library preparation kit
      LIBRARY_PREPARATION_KIT_VENDOR:
        range: string
        required: false
        description: Vendor of the library preparation kit
      LIBRARY_PREPARATION_KIT_VERSION:
        range: string
        required: false
        description: Version of the library preparation kit
      SEQUENCING_PLATFORM:
        range: SequencingPlatformEnum
        required: true
        description: Sequencing platform used
      ADAPTER_NAME:
        range: string
        required: false
        description: Name of the adapter used
      ADAPTER_SEQUENCE:
        range: string
        required: false
        description: Adapter sequence
      BASE_CALLER_NAME:
        range: string
        required: false
        description: Name of the base caller
      BASE_CALLER_VERSION:
        range: string
        required: false
        description: Version of the base caller
      FLOW_CELL_BARCODE:
        range: string
        required: false
        description: Flow cell barcode
      FRAGMENT_MAXIMUM_LENGTH:
        range: integer
        required: false
        description: Maximum fragment length
      FRAGMENT_MEAN_LENGTH:
        range: integer
        required: false
        description: Mean fragment length
      FRAGMENT_MINIMUM_LENGTH:
        range: integer
        required: false
        description: Minimum fragment length
      FRAGMENT_STANDARD_DEVIATION_LENGTH:
        range: integer
        required: false
        description: Standard deviation of fragment length
      LANE_NUMBER:
        range: integer
        required: false
        description: Lane number
      MULTIPLEX_BARCODE:
        range: string
        required: false
        description: Multiplex barcode
      LIBRARY_PREPARATION_DAYS_FROM_INDEX:
        range: integer
        required: false
        description: Days from index for library preparation
      SIZE_SELECTION_RANGE:
        range: string
        required: false
        description: Size selection range
      TARGET_DEPTH:
        range: integer
        required: false
        description: Target sequencing depth
      TO_TRIM_ADAPTER_SEQUENCE:
        range: boolean
        required: false
        description: Whether to trim adapter sequence

  BulkWESLevel2:
    description: Bulk Whole Exome Sequencing Level 2 - Aligned files and QC
    attributes:
      COMPONENT:
        range: string
        required: true
        description: Category of metadata (should be "Bulk WES Level 2")
      FILENAME:
        range: string
        required: true
        description: Name of the file
      FILE_FORMAT:
        range: string
        required: true
        description: Format of the file (e.g., bam, bai)
      HTAN_PARENT_DATA_FILE_ID:
        range: string
        required: true
        description: HTAN Data File ID of the parent data file
      HTAN_DATA_FILE_ID:
        range: string
        required: true
        description: HTAN Data File ID
      ALIGNMENT_WORKFLOW_TYPE:
        range: string
        required: true
        description: Type of alignment workflow used
      GENOMIC_REFERENCE:
        range: string
        required: true
        description: Genomic reference used for alignment
      GENOMIC_REFERENCE_URL:
        range: string
        required: false
        description: URL to the genomic reference
      INDEX_FILE_NAME:
        range: string
        required: false
        description: Name of the index file
      AVERAGE_BASE_QUALITY:
        range: float
        required: false
        description: Average base quality
      AVERAGE_INSERT_SIZE:
        range: integer
        required: false
        description: Average insert size
      AVERAGE_READ_LENGTH:
        range: integer
        required: false
        description: Average read length
      CONTAMINATION:
        range: float
        required: false
        description: Contamination estimate
      CONTAMINATION_ERROR:
        range: float
        required: false
        description: Contamination error estimate
      MEAN_COVERAGE:
        range: float
        required: true
        description: Mean coverage depth
      ADAPTER_CONTENT:
        range: string
        required: false
        description: Adapter content information
      BASIC_STATISTICS:
        range: string
        required: false
        description: Basic statistics from QC
      ENCODING:
        range: string
        required: false
        description: Encoding information
      OVERREPRESENTED_SEQUENCES:
        range: string
        required: false
        description: Overrepresented sequences
      PER_BASE_N_CONTENT:
        range: string
        required: false
        description: Per base N content
      PER_BASE_SEQUENCE_CONTENT:
        range: string
        required: false
        description: Per base sequence content
      PER_BASE_SEQUENCE_QUALITY:
        range: string
        required: false
        description: Per base sequence quality
      PER_SEQUENCE_GC_CONTENT:
        range: string
        required: false
        description: Per sequence GC content
      PER_SEQUENCE_QUALITY_SCORE:
        range: string
        required: false
        description: Per sequence quality score
      PER_TILE_SEQUENCE_QUALITY:
        range: string
        required: false
        description: Per tile sequence quality
      PERCENT_GC_CONTENT:
        range: float
        required: false
        description: Percent GC content
      SEQUENCE_DUPLICATION_LEVELS:
        range: string
        required: false
        description: Sequence duplication levels
      SEQUENCE_LENGTH_DISTRIBUTION:
        range: string
        required: false
        description: Sequence length distribution
      QC_WORKFLOW_TYPE:
        range: string
        required: false
        description: QC workflow type
      QC_WORKFLOW_VERSION:
        range: string
        required: false
        description: QC workflow version
      QC_WORKFLOW_LINK:
        range: string
        required: false
        description: Link to QC workflow
      MSI_WORKFLOW_LINK:
        range: string
        required: false
        description: Link to MSI workflow
      MSI_SCORE:
        range: float
        required: false
        description: MSI score
      MSI_STATUS:
        range: MSIStatusEnum
        required: false
        description: MSI status
      PAIRS_ON_DIFF_CHR:
        range: integer
        required: false
        description: Number of read pairs on different chromosomes
      TOTAL_READS:
        range: integer
        required: true
        description: Total number of reads
      TOTAL_UNIQUELY_MAPPED:
        range: integer
        required: true
        description: Total number of uniquely mapped reads
      TOTAL_UNMAPPED_READS:
        range: integer
        required: true
        description: Total number of unmapped reads
      PROPORTION_READS_DUPLICATED:
        range: float
        required: false
        description: Proportion of duplicated reads
      PROPORTION_READS_MAPPED:
        range: float
        required: true
        description: Proportion of mapped reads
      PROPORTION_TARGETS_NO_COVERAGE:
        range: float
        required: false
        description: Proportion of targets with no coverage
      PROPORTION_BASE_MISMATCH:
        range: float
        required: false
        description: Proportion of base mismatches
      SHORT_READS:
        range: integer
        required: false
        description: Number of short reads
      PROPORTION_COVERAGE_10X:
        range: float
        required: false
        description: Proportion of coverage at 10x
      PROPORTION_COVERAGE_30X:
        range: float
        required: false
        description: Proportion of coverage at 30x
      IS_LOWEST_LEVEL:
        range: boolean
        required: false
        description: Whether this is the lowest level

  BulkWESLevel3:
    description: Bulk Whole Exome Sequencing Level 3 - Called variants
    attributes:
      COMPONENT:
        range: string
        required: true
        description: Category of metadata (should be "Bulk WES Level 3")
      FILENAME:
        range: string
        required: true
        description: Name of the file
      FILE_FORMAT:
        range: string
        required: true
        description: Format of the file (e.g., vcf, bcf, maf)
      HTAN_PARENT_DATA_FILE_ID:
        range: string
        required: true
        description: HTAN Data File ID of the parent data file
      HTAN_DATA_FILE_ID:
        range: string
        required: true
        description: HTAN Data File ID
      GENOMIC_REFERENCE:
        range: string
        required: true
        description: Genomic reference used for variant calling
      GENOMIC_REFERENCE_URL:
        range: string
        required: false
        description: URL to the genomic reference
      GERMLINE_VARIANTS_WORKFLOW_URL:
        range: string
        required: false
        description: URL to the germline variants workflow
      GERMLINE_VARIANTS_WORKFLOW_TYPE:
        range: string
        required: false
        description: Type of germline variants workflow
      SOMATIC_VARIANTS_WORKFLOW_URL:
        range: string
        required: false
        description: URL to the somatic variants workflow
      SOMATIC_VARIANTS_WORKFLOW_TYPE:
        range: string
        required: false
        description: Type of somatic variants workflow
      SOMATIC_VARIANTS_SAMPLE_TYPE:
        range: SomaticVariantsSampleTypeEnum
        required: false
        description: Type of sample for somatic variants
      STRUCTURAL_VARIANT_WORKFLOW_URL:
        range: string
        required: false
        description: URL to the structural variant workflow
      STRUCTURAL_VARIANT_WORKFLOW_TYPE:
        range: string
        required: false
        description: Type of structural variant workflow
